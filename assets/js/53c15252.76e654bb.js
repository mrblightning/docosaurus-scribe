"use strict";(self.webpackChunkscribe=self.webpackChunkscribe||[]).push([[48],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(t),m=i,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return t?r.createElement(h,a(a({ref:n},p),{},{components:t})):r.createElement(h,a({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,a=new Array(o);a[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=t[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6858:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},assets:function(){return p},toc:function(){return u},default:function(){return m}});var r=t(7462),i=t(3366),o=(t(7294),t(3905)),a=["components"],s={sidebar_position:1},l="Jenkins",c={unversionedId:"ci-integration/jenkins",id:"ci-integration/jenkins",title:"Jenkins",description:"Important to note that this is for Jenkins over Kubernetes only.",source:"@site/docs/ci-integration/jenkins.md",sourceDirName:"ci-integration",slug:"/ci-integration/jenkins",permalink:"/docosaurus-scribe/docs/ci-integration/jenkins",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"CI Integration",permalink:"/docosaurus-scribe/docs/ci-integration/"},next:{title:"GitHub Actions",permalink:"/docosaurus-scribe/docs/ci-integration/github-actions"}},p={},u=[{value:"Adding new credentials in Jenkins",id:"adding-new-credentials-in-jenkins",level:2},{value:"Scribe <em>SBOM</em> upload - full pipeline",id:"scribe-sbom-upload---full-pipeline",level:2}],d={toc:u};function m(e){var n=e.components,t=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"jenkins"},"Jenkins"),(0,o.kt)("p",null,"Important to note that this is for Jenkins over Kubernetes only."),(0,o.kt)("p",null,"In order for the integration with Scribe Hub to work you must first make sure you have the secrets provided for you at the ",(0,o.kt)("a",{href:"https://beta.hub.scribesecurity.com"},"'add project'")," page. Of the provided secrets, ",(0,o.kt)("inlineCode",{parentName:"p"},"clientid")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"clientsecret")," are identical for all your future projects and ",(0,o.kt)("inlineCode",{parentName:"p"},"productkey")," is unique for this particular project only."),(0,o.kt)("h2",{id:"adding-new-credentials-in-jenkins"},"Adding new credentials in Jenkins"),(0,o.kt)("p",null,"The instructions to add credentials to setting up Jenkins credentials can be found",(0,o.kt)("a",{href:"https://www.jenkins.io/doc/book/using/using-credentials/"},"here"),". For your convenience we present the instructions here as well. "),(0,o.kt)("p",null,"To add new global credentials to your Jenkins instance:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"If required, ensure you are logged in to Jenkins (as a user with the ",(0,o.kt)("b",null,"Credentials > Create")," permission)."),(0,o.kt)("li",{parentName:"ol"},"From the Jenkins home page (i.e. the Dashboard of the Jenkins classic UI), click ",(0,o.kt)("b",null,"Manage Jenkins > Manage Credentials"),". ",(0,o.kt)("img",{src:"../../img/ci/jenkins-manage.png",alt:"Manage",width:"100%"})),(0,o.kt)("li",{parentName:"ol"},"Under ",(0,o.kt)("b",null,"Stores scoped to Jenkins")," on the right, click on ",(0,o.kt)("b",null,"Jenkins"),". ",(0,o.kt)("img",{src:"../../img/ci/jenkins-store.png",alt:"Store",width:"60%"})),(0,o.kt)("li",{parentName:"ol"},"Under ",(0,o.kt)("b",null,"System"),", click the ",(0,o.kt)("b",null,"Global credentials (unrestricted)")," link to access this default domain. ",(0,o.kt)("img",{src:"../../img/ci/system_global_credentials.png",alt:"System Global Credentials",width:"100%"})),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("b",null,"Add Credentials")," on the left."),(0,o.kt)("li",{parentName:"ol"},"From the ",(0,o.kt)("b",null,"Kind")," field, choose the type of credentials to add."),(0,o.kt)("li",{parentName:"ol"},"From the Scope field, choose ",(0,o.kt)("b",null,"Global"),' since the credentials to be added are for a Pipeline project/item. Choosing this option applies the scope of the credentials to the Pipeline project/item "object" and all its descendent objects.'),(0,o.kt)("li",{parentName:"ol"},"Add the credentials themselves into the appropriate fields for your chosen credential type. In this case all of the credentials we're adding are of the type ",(0,o.kt)("b",null,"Secret text"),". You should copy the secret text and paste it into the ",(0,o.kt)("b",null,"Secret")," field."),(0,o.kt)("li",{parentName:"ol"},"In the ",(0,o.kt)("b",null,"ID")," field, specify a meaningful credential ID value, for example ",(0,o.kt)("inlineCode",{parentName:"li"},"jenkins-clientid-for-xyz-repository"),". The inbuilt (default) credentials provider can use upper- or lower-case letters for the credential ID, as well as any valid separator character, other credential providers may apply further restrictions on allowed characters or lengths. However, for the benefit of all users on your Jenkins instance, it is best to use a single and consistent convention for specifying credential IDs. ",(0,o.kt)("b",null,"Note"),": This field is optional. If you do not specify its value, Jenkins assigns a globally unique ID (GUID) value for the credential ID. Bear in mind that once a credential ID is set, it can no longer be changed."),(0,o.kt)("li",{parentName:"ol"},"Specify an optional ",(0,o.kt)("b",null,"Description")," for the credential."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("b",null,"OK")," to save the credentials.")),(0,o.kt)("h2",{id:"scribe-sbom-upload---full-pipeline"},"Scribe ",(0,o.kt)("em",{parentName:"h2"},"SBOM")," upload - full pipeline"),(0,o.kt)("p",null,"This is a full workflow example, connecting your pipeline to Scribe Hub and uploading evidence using ",(0,o.kt)("em",{parentName:"p"},"gensbom"),"."),(0,o.kt)("p",null,"This example pipeline Jenkinsfile does a checkout on a docker image, creates an ",(0,o.kt)("em",{parentName:"p"},"SBOM")," for it from the local repository, and creates another ",(0,o.kt)("em",{parentName:"p"},"SBOM")," from the docker image. In this example the project used is ",(0,o.kt)("inlineCode",{parentName:"p"},"mongo-express"),".  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"pipeline {\n    agent {\n        kubernetes {\n            metadata:\n              labels:\n                some-label: jsl-scribe-test\n            spec:\n              containers:\n              - name: jnlp\n                env:\n                - name: CONTAINER_ENV_VAR\n                  value: jnlp\n              - name: bomber\n                // taking the image from scribesecuriy means you don't need to have a local version\n                image: scribesecuriy.jfrog.io/scribe-docker-public-local/bomber:latest \n                command:\n                - cat\n                tty: true\n                command:\n                - cat\n                tty: true\n              - name: git\n                image: alpine/git\n                command:\n                  - cat\n                tty: true\n        }\n    }\n    stages {\n        stage('checkout-bom') {\n            steps {\n                container('git') {\n                    // this is an example of the repository this pipeline is running on. replace with your own repository\n                    sh 'git clone -b v1.0.0-alpha.4 --single-branch https://github.com/mongo-express/mongo-express.git mongo-express-scm'\n                }\n\n                container('gensbom') {\n                    // these credentials can be copied from your CLI page: \n                    withCredentials([usernamePassword(credentialsId: 'scribe-staging-auth-id', usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                        // this stage creats the first SBOM\n                        // it is created on the local directory, running on the source code of the image\n                        sh '''\n                        gensbom bom dir:mongo-express-scm \\\n                            --context-type jenkins \\\n                            --output-directory ./scribe/gensbom \\ \n                            -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                            --product-key $SCRIBE_PRODUCT_KEY \\\n                            -v '''\n                    }\n                }\n            }\n        }\n\n        stage('image-bom') {\n            steps {\n                container('gensbom') {\n                    // these credentials can be copied from your CLI page: https://beta.hub.scribesecurity.com\n                    withCredentials([usernamePassword(credentialsId: 'scribe-staging-auth-id', usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                        // this stage creats the second SBOM \n                        // the SBOM is created on the docker image, running on the uploaded image of this repository\n                        sh '''\n                        gensbom bom mongo-express:1.0 .0-alpha.4 \\\n                            --context-type jenkins \\\n                            --output-directory ./scribe/gensbom \\ \n                            -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                            --product-key $SCRIBE_PRODUCT_KEY \\\n                            -v '''\n                    }\n                }\n            }\n        }\n    }\n}\n")))}m.isMDXComponent=!0}}]);