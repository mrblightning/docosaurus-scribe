"use strict";(self.webpackChunkscribe=self.webpackChunkscribe||[]).push([[48],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return g}});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(t),g=i,d=m["".concat(l,".").concat(g)]||m[g]||u[g]||a;return t?r.createElement(d,o(o({ref:n},p),{},{components:t})):r.createElement(d,o({ref:n},p))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6858:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},assets:function(){return p},toc:function(){return u},default:function(){return g}});var r=t(7462),i=t(3366),a=(t(7294),t(3905)),o=["components"],s={sidebar_position:1,sidebar_label:"Jenkins"},l="Integrating Scribe in your Jenkins pipeline",c={unversionedId:"ci-integration/jenkins",id:"ci-integration/jenkins",title:"Integrating Scribe in your Jenkins pipeline",description:"Before you begin",source:"@site/docs/ci-integration/jenkins.md",sourceDirName:"ci-integration",slug:"/ci-integration/jenkins",permalink:"/docosaurus-scribe/docs/ci-integration/jenkins",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"Jenkins"},sidebar:"tutorialSidebar",previous:{title:"Setting up Scribe protection in your CI pipeline",permalink:"/docosaurus-scribe/docs/ci-integration/"},next:{title:"GitHub Actions",permalink:"/docosaurus-scribe/docs/ci-integration/github-actions"}},p={},u=[{value:"Before you begin",id:"before-you-begin",level:2},{value:"Procedure",id:"procedure",level:2}],m={toc:u};function g(e){var n=e.components,t=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"integrating-scribe-in-your-jenkins-pipeline"},"Integrating Scribe in your Jenkins pipeline"),(0,a.kt)("h2",{id:"before-you-begin"},"Before you begin"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"This procedure is supported only for Jenkins over Kubernetes.")),(0,a.kt)("p",null,"Integrating Scribe Hub with Jenkins requires the following credentials that are found in the product setup dialog (In your ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://prod.hub.scribesecurity.com/",title:"Scribe Hub Link"},"Scribe Hub"))," go to Home>Products>","[$product]",">Setup)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"product key")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"client id")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"client secret"))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Note that the product key is unique per product, while the client id and secret are unique for your account.")),(0,a.kt)("h2",{id:"procedure"},"Procedure"),(0,a.kt)("p",null,"Every integration pipeline is unique.\nIntegrating Scribe code to your pipeline varies from one case to another."),(0,a.kt)("p",null,"The following is an example that illustrates where to add Scribe code snippets. "),(0,a.kt)("p",null,"This example uses a sample pipeline building a Mongo express project. "),(0,a.kt)("p",null,"The code snippets call ",(0,a.kt)("inlineCode",{parentName:"p"},"gensbom"),", the evidence collector and SBOM generator developed by Scribe, twice: at checkout and after creating the Docker image."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Add the credentials to your environment according to the ",(0,a.kt)("a",{parentName:"li",href:"https://www.jenkins.io/doc/book/using/using-credentials/",title:"Jenkins Instructions"},"Jenkins instructions"),". Following the code example below, be sure to use the names ",(0,a.kt)("strong",{parentName:"li"},"usernameVariable")," for the ",(0,a.kt)("strong",{parentName:"li"},"client-id"),", ",(0,a.kt)("strong",{parentName:"li"},"passwordVariable")," for the  ",(0,a.kt)("strong",{parentName:"li"},"client-secret")," and ",(0,a.kt)("strong",{parentName:"li"},"productkeyVariable")," for the ",(0,a.kt)("strong",{parentName:"li"},"product-key"),"."),(0,a.kt)("li",{parentName:"ol"},"Add Code snippets to your pipeline:   ",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Add ",(0,a.kt)("inlineCode",{parentName:"li"},"gensbom")," declarations to the container definitions.")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"          - name: gensbom\n            // taking the image from scribesecuriy means you don't need to have a local version\n            image: scribesecuriy.jfrog.io/scribe-docker-public-local/gensbom:latest \n            command:\n            - cat\n            tty: true\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Replace the ",(0,a.kt)("inlineCode",{parentName:"li"},"Mongo express")," repo in the example with your repo name.")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"            container('git') {\n                sh 'git clone -b <repo version> --single-branch <link to repository> <repo name>'\n            }\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Call ",(0,a.kt)("inlineCode",{parentName:"li"},"gensbom")," right after checkout to collect hash value evidence of the source code files.")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"          container('gensbom') {\n                withCredentials([usernamePassword(usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                    sh '''\n                    gensbom dir:<repo-name> \\\n                        --context-type jenkins \\\n                        --output-directory ./scribe/gensbom \\ \n                        -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                        --product-key $SCRIBE_PRODUCT_KEY \\\n                        -v '''\n                }\n            }\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Call ",(0,a.kt)("inlineCode",{parentName:"li"},"gensbom")," to generate an SBOM from the final Docker image.")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"    stage('image-bom') {\n        steps {\n            container('gensbom') {\n                withCredentials([usernamePassword(usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                    sh '''\n                    gensbom <image-name:tag> \\\n                        --context-type jenkins \\\n                        --output-directory ./scribe/gensbom \\ \n                        -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                        --product-key $SCRIBE_PRODUCT_KEY \\\n                        -v '''\n                }\n            }\n        }\n    }\n")))),(0,a.kt)("p",null,"Here's the full example pipeline:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"pipeline {\n    agent {\n        kubernetes {\n            metadata:\n              labels:\n                some-label: jsl-scribe-test\n            spec:\n              containers:\n              - name: jnlp\n                env:\n                - name: CONTAINER_ENV_VAR\n                  value: jnlp\n              - name: gensbom\n                // taking the image from scribesecuriy means you don't need to have a local version\n                image: scribesecuriy.jfrog.io/scribe-docker-public-local/gensbom:latest \n                command:\n                - cat\n                tty: true\n              - name: git\n                image: alpine/git\n                command:\n                  - cat\n                tty: true\n        }\n    }\n    stages {\n        stage('checkout-bom') {\n            steps {\n                container('git') {\n                    // this is an example of the repository this pipeline is running on. replace with your own repository\n                    sh 'git clone -b v1.0.0-alpha.4 --single-branch https://github.com/mongo-express/mongo-express.git mongo-express-scm'\n                }\n                // The following call to gensbom collects hash value evidence of the source code files to facilitate the integrity validation\n                container('gensbom') {\n                    withCredentials([usernamePassword(usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                        sh '''\n                        gensbom dir:mongo-express-scm \\\n                            --context-type jenkins \\\n                            --output-directory ./scribe/gensbom \\ \n                            -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                            --product-key $SCRIBE_PRODUCT_KEY \\\n                            -v '''\n                    }\n                }\n            }\n        }\n\n        stage('image-bom') {\n            steps {\n                // The following call to gensbom generates an SBOM from the docker image\n                container('gensbom') {\n                    withCredentials([usernamePassword(usernameVariable: 'SCRIBE_CLIENT_ID', passwordVariable: 'SCRIBE_CLIENT_SECRET', productkeyVariable: 'SCRIBE_PRODUCT_KEY')]) {\n                        sh '''\n                        gensbom mongo-express:1.0.0-alpha.4 \\\n                            --context-type jenkins \\\n                            --output-directory ./scribe/gensbom \\ \n                            -E -U $SCRIBE_CLIENT_ID -P $SCRIBE_CLIENT_SECRET \\\n                            --product-key $SCRIBE_PRODUCT_KEY \\\n                            -v '''\n                    }\n                }\n            }\n        }\n    }\n}\n")))}g.isMDXComponent=!0}}]);